@inherits LayoutComponentBase
@using MudBlazor
@using WindTurbine.App.Services
@inject UserSession UserSession

<MudThemeProvider Theme="_customTheme" />
<MudDialogProvider />
<MudSnackbarProvider />

<MudLayout>
    <MudAppBar Elevation="1" Style="background-color: white; color: #424242;">
        <MudIconButton Icon="@Icons.Material.Filled.Menu" Color="Color.Inherit" Edge="Edge.Start" OnClick="@((e) => DrawerToggle())" />
        <MudText Typo="Typo.h6" Class="ml-3" Style="font-weight: 800; letter-spacing: 1px; color: #1a237e;">WIND MANAGER</MudText>
        <MudSpacer />

        <MudIconButton Icon="@Icons.Material.Filled.NotificationsNone" Color="Color.Inherit" Title="Bildirim Yok" />

        <MudAvatar Color="Color.Primary" Size="Size.Small" Class="ml-3" Style="font-size: 0.8rem;">
            @(string.IsNullOrEmpty(UserSession.FullName) ? "M" : UserSession.FullName.Substring(0, 1).ToUpper())
        </MudAvatar>
    </MudAppBar>

    <MudDrawer @bind-Open="_drawerOpen" 
               ClipMode="DrawerClipMode.Always" 
               Elevation="0" 
               Variant="@DrawerVariant.Responsive" 
               Width="260px"
               Style="background-color: #0d47a1; color: white;">

        <div class="d-flex flex-column mud-height-full">

            <MudNavMenu Class="pt-8 flex-grow-1">
                <MudText Typo="Typo.overline" Class="px-4 mb-2 d-block" Style="color: #90caf9; font-weight: bold;">GENEL BAKIŞ</MudText>

                <MudNavLink Href="/dashboard" Icon="@Icons.Material.Filled.Dashboard" IconColor="Color.Inherit" Class="nav-item-custom">Ana Sayfa</MudNavLink>
                <MudNavLink Href="/turbines" Icon="@Icons.Material.Filled.WindPower" IconColor="Color.Inherit" Class="nav-item-custom">Türbinler</MudNavLink>
                <MudNavLink Href="/map" Icon="@Icons.Material.Filled.Map" IconColor="Color.Inherit" Class="nav-item-custom">Harita</MudNavLink>

                <MudText Typo="Typo.overline" Class="px-4 mt-6 mb-2 d-block" Style="color: #90caf9; font-weight: bold;">YÖNETİM</MudText>
                <MudNavLink Href="/alerts" Icon="@Icons.Material.Filled.WarningAmber" IconColor="Color.Inherit" Class="nav-item-custom">Alarmlar</MudNavLink>
                <MudNavLink Href="/reports" Icon="@Icons.Material.Filled.Analytics" IconColor="Color.Inherit" Class="nav-item-custom">Raporlar</MudNavLink>
                <MudNavLink Href="/settings" Icon="@Icons.Material.Filled.Settings" IconColor="Color.Inherit" Class="nav-item-custom">Ayarlar</MudNavLink>
            </MudNavMenu>

            <MudNavMenu Class="pb-4">
                <MudDivider Class="mb-2 mx-4" Style="background-color: rgba(255,255,255,0.2);" />
                <MudNavLink Href="/" Icon="@Icons.Material.Filled.Logout" IconColor="Color.Error" Class="nav-item-custom" Style="color: #ffcdd2 !important;">Çıkış Yap</MudNavLink>
            </MudNavMenu>

        </div>
    </MudDrawer>

    <MudMainContent Style="background-color: #f5f7fa; min-height: 100vh;">
        <MudContainer MaxWidth="MaxWidth.Large" Class="pt-8 px-6">
            @Body
        </MudContainer>
    </MudMainContent>
</MudLayout>

@code {
    bool _drawerOpen = true;
    void DrawerToggle() => _drawerOpen = !_drawerOpen;

    private MudTheme _customTheme = new MudTheme()
        {
            PaletteLight = new PaletteLight()
            {
                Primary = "#0d47a1",
                Secondary = "#ff9800",
                AppbarBackground = "#ffffff",
                Background = "#f5f7fa",
                TextPrimary = "#37474f",
                DrawerBackground = "#0d47a1",
                DrawerText = "#ffffff",
                DrawerIcon = "#ffffff"
            }
        };
}